---

- name: AWS ECR login
  ansible.builtin.command: aws ecr get-login --no-include-email
  register: command_output
  become: yes
  become_user: firstboot
  no_log: True

- name: Docker login
  ansible.builtin.command: "{{command_output.stdout}}"
  no_log: True

- name: Stop pod containers
  ansible.builtin.shell: "docker stop $(docker ps -a -q) || true"

- name: Remove all containers
  ansible.builtin.shell: "docker rm $(docker ps -a -q) || true"
